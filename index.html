<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
    <link rel="stylesheet" href="https://use.typekit.net/fva6zoc.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Hellmann's Heroes | Level 1</title>
    <link rel="icon" type="image/x-icon" href="images/favicon-02.png">
    <link rel="stylesheet" href="styles/new_york/style.css">
  </head>

  <body>

    <!-- Game Menu -->
    <div id="gameMenu" class="menu">
      <h1>HELLMANN'S</h1>
      <h2>HEROES®</h2>

      <button id="startGame">Play Game!</button>

      <div class="button-container">
        <button id="howToPlay">How to Play</button>
        <button id="aboutGame">About</button>
      </div>

      <div id="funFact">Fun Fact: Loading...</div>

      <div id="created_by">
        Developed and Designed by Chanel Clarke<br>
        To see more of my work, visit
        <a id="portfolio" target="_blank" href="https://chanel-design.com/">chanel-design.com</a>
      </div>
    </div>

    <!-- Game Canvas -->
    <canvas id="gameCanvas"></canvas>
    <button id="nextWorldButton" style="display:none;">Level 2</button>

    <!-- Assets -->
    <div class="assets">
      <img id="background" src="images/game_bgs/new_york.png">
      <img id="player_mayo" src="images/player_sprite_sheet_1.png">
      <img id="ketchup" src="images/obstacle_sprite_sheet_1.png">

      <audio id="bg_music" src="audio/bg_music_1.mp3"></audio>
      <audio id="buttonClickSound" src="audio/click.wav"></audio>
      <audio id="charge" src="audio/charge.mp3"></audio>
      <audio id="flap1" src="audio/flap1.mp3"></audio>
      <audio id="flap2" src="audio/flap2.mp3"></audio>
      <audio id="flap3" src="audio/flap3.mp3"></audio>
      <audio id="flap4" src="audio/flap4.mp3"></audio>
      <audio id="flap5" src="audio/flap5.mp3"></audio>
      <audio id="win" src="audio/win.mp3"></audio>
      <audio id="lose" src="audio/lose.mp3"></audio>
    </div>

    <!-- Game Scripts -->
    <script src="scripts/new_york/audio.js"></script>
    <script src="scripts/new_york/background.js"></script>
    <script src="scripts/new_york/player.js"></script>
    <script src="scripts/new_york/obstacle.js"></script>
    <script src="scripts/new_york/main.js"></script>

    <!-- Popup -->
    <div id="popup" class="popup">
      <div class="popup-content">
        <span id="popupClose" class="popup-close">&times;</span>
        <h2 id="popupTitle"></h2>
        <p id="popupText"></p>
      </div>
    </div>

    <script>
      /* ---------- CLICK SOUND (GLOBAL) ---------- */
      function playClickSound() {
        const sound = document.getElementById('buttonClickSound');
        if (!sound) return;
        sound.currentTime = 0;
        sound.play();
      }

      /* Auto-play click sound for ALL buttons + popup close */
      document.addEventListener('click', e => {
        if (
          e.target.tagName === 'BUTTON' ||
          e.target.classList.contains('popup-close')
        ) {
          playClickSound();
        }
      });

      /* ---------- START GAME ---------- */
      document.getElementById('startGame').addEventListener('click', () => {
        const menu = document.getElementById("gameMenu");
        menu.style.transition = "opacity 0.5s";
        menu.style.opacity = "0";

        setTimeout(() => {
          menu.style.display = "none";
          startGame();
        }, 500);
      });

      function startGame() {
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 720;
        canvas.height = 720;

        const game = new Game(canvas, ctx);
        let lastTime = 0;

        function animate(timeStamp) {
          const deltaTime = timeStamp - lastTime;
          lastTime = timeStamp;
          game.render(deltaTime);
          requestAnimationFrame(animate);
        }

        requestAnimationFrame(animate);
      }

      /* ---------- NEXT LEVEL ---------- */
      document.getElementById('nextWorldButton').addEventListener('click', () => {
        window.location.href = "scripts/picnic/level2.html";
      });

      /* ---------- POPUPS ---------- */
      document.getElementById('howToPlay').addEventListener('click', () => {
        document.getElementById('popup').style.display = 'block';
        document.getElementById('popupTitle').innerText = 'How to Play';
        document.getElementById('popupText').innerText =
          "Press Space, click or tap to fly.\n\nPress 'C' or swipe to charge.\n\nReach the end of each level to unlock the next.";
      });

      document.getElementById('aboutGame').addEventListener('click', () => {
        document.getElementById('popup').style.display = 'block';
        document.getElementById('popupTitle').innerText = 'About';
        document.getElementById('popupText').innerText =
          "Hellmann's Heroes® is my response to the D&AD New Blood Hellmann's 2025 brief.\n\nDeveloped and designed by Chanel Clarke.";
      });

      document.getElementById('popupClose').addEventListener('click', () => {
        document.getElementById('popup').style.display = 'none';
      });

      /* ---------- FUN FACT ---------- */
      function displayRandomFunFact() {
        const facts = [
          "Hellmann's is the #1 mayo brand in the U.S.",
          "Hellmann's was founded in New York in 1905.",
          "Hellmann's helps reduce food waste.",
          "Hellmann's spreads better than butter!"
        ];
        document.getElementById('funFact').innerText =
          'Fun Fact: ' + facts[Math.floor(Math.random() * facts.length)];
      }

      window.onload = displayRandomFunFact;

      /* ---------- UNLOCK AUDIO ---------- */
      window.addEventListener('click', () => {
        document.getElementById("bg_music").play();
      }, { once: true });
    </script>

  </body>
</html>
